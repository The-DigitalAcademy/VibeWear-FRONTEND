<div class="container mt-4">
  <div class="card shadow-sm p-3">
    <div class="row">
      <!-- CART SECTION -->
      <div class="col-md-8 cart">
        <div class="title mb-3">
          <div class="row">
            <div class="col">
              <h4><b>Shopping Cart</b></h4>
            </div>
            <div class="col align-self-center text-end text-muted ">
              <button
                class="btn btn-outline-danger btn-sm btn"
                (click)="clearCart()"
                [disabled]="cartItems.length === 0"
              >
                Clear Cart
                </button>
            </div>  
          </div>
        </div>

        <!-- Empty Cart Message -->
        <div *ngIf="cartItems.length === 0" class="alert alert-info">
          Your cart is empty.
          <a routerLink="/products" class="alert-link">Continue shopping</a>
        </div>

        <!-- Dynamic Cart Items -->
        <div *ngIf="cartItems.length > 0">
          <div
            class="row border-top border-bottom py-2"
            *ngFor="let item of cartItems"
          >
            <div class="row main align-items-center">
              <div class="col-2">
                <img
                  [src]="item.image"
                  [alt]="item.title"
                  class="img-fluid rounded"
                  style="object-fit: contain; height: 80px"
                />
              </div>

              <div class="col">
                <div class="row text-muted">{{ item.title }}</div>
                <div class="row small text-secondary">
                  Price: R{{ item.price | number : '1.2-2' }}
                </div>
              </div>

              <div class="col text-center">
                <div class="d-flex justify-content-center align-items-center">
                  <a
                    href="#"
                    class="px-2"
                    (click)="updateQuantity(item.id, item.quantity - 1); $event.preventDefault()"
                    >−</a
                  >
                  <span class="border px-2">{{ item.quantity }}</span>
                  <a
                    href="#"
                    class="px-2"
                    (click)="updateQuantity(item.id, item.quantity + 1); $event.preventDefault()"
                    >+</a
                  >
                </div>
              </div>

              <div class="col text-end">
                R{{ item.price * item.quantity | number : '1.2-2' }}
                <span
                  class="text-danger ms-2"
                  style="cursor: pointer"
                  (click)="removeItem(item.id)"
                  title="Remove item"
                  >&times;</span
                >
              </div>
            </div>
          </div>

          <div class="back-to-shop mt-3">
            <a routerLink="/products">&leftarrow;</a>
            <span class="text-muted ms-2">Back to shop</span>
          </div>
        </div>
      </div>

      <!-- SUMMARY SECTION -->
     <div class="col-md-4 summary bg-light p-4 rounded">
  <div>
    <h5><b>Summary</b></h5>
  </div>
  <hr />

  <div class="row">
    <div class="col">ITEMS {{ cartItems.length }}</div>
    <div class="col text-end">R{{ totalPrice | number: '1.2-2' }}</div>
  </div>

  <form class="mt-3">
    <p class="mb-1">SHIPPING</p>
    <select class="form-select mb-3" (change)="onShippingChange($event)" [disabled]="cartItems.length === 0">
      <option value="free">Free Shipping – R0.00</option>
      <option value="standard">Standard Delivery – R50.00</option>
      <option value="express">Express Delivery – R120.00</option>
    </select>

    <p class="mb-1">DISCOUNT CODE</p>
    <div class="input-group mb-3 disable">
      <input
        id="code"
        placeholder="Enter your code"
        class="form-control"
        name="discountCode"
      />
      <button
        type="button"
        class="btn btn-outline-secondary"
        
        (click)="applyDiscount()"
      >
        Apply
      </button>
    </div>
  </form>

  <div class="row mt-3">
    <div class="col">Shipping</div>
    <div class="col text-end">R{{ shippingCost | number: '1.2-2' }}</div>
  </div>

  <div class="row">
    <div class="col">Discount</div>
    <div class="col text-end text-success">−R{{ discount | number: '1.2-2' }}</div>
  </div>

  <div class="row mt-3 pt-3 border-top border-secondary-subtle">
    <div class="col">
      <strong>GRAND TOTAL</strong>
    </div>
    <div class="col text-end">
      <strong>R{{ grandTotal | number: '1.2-2' }}</strong>
    </div>
  </div>

  <button
    class="btn btn-primary w-100 mt-3"
    data-bs-toggle="modal"
    data-bs-target="#checkoutModal"
    [disabled]="cartItems.length === 0"
  >
    CHECKOUT
  </button>
</div>

    </div>
  </div>
</div>

<!-- Checkout Modal -->
<div
  class="modal fade"
  id="checkoutModal"
  tabindex="-1"
  aria-labelledby="checkoutModalLabel"
  aria-hidden="true"
>
  <app-check-out-pop-up></app-check-out-pop-up>
</div>
